.container.advanced-search
	#spin style="display:none;"  
	= search_form_for @search_horses, url: horses_result_path, :html => {role: "form"} do |f|

		.row
		  .col-md-6
	      h4 Breeds
	      .row
	      	- @breeds.in_groups_of(7).each do |breed_group|
	      		.col-md-6
	      			- breed_group.each do |breed|
	      				- unless breed.nil?
	      					= check_box_tag "q_breed_cont_any_#{breed.id}", breed.name, breed.checked, name: 'q[breed_cont_any][]'

	      					= label_tag "q_breed_cont_any_#{breed.id}", breed.name
	      					br

			.col-md-6
	      h4 Gender
	      .row
	      	- @genders.in_groups_of(7).each do |gender_group|
	      		.col-md-6
	      			- gender_group.each do |gender|
	      				- unless gender.nil?
	      					= check_box_tag "q_gender_cont_any_#{gender.id}", gender.name, gender.checked, name: 'q[gender_cont_any][]'
	      					= label_tag "q_gender_cont_any_#{gender.id}", gender.name
	      					br 	
		.row
			h4 Locations
			- @states.in_groups_of(20).each do |state_group|
				.col-md-3
					- state_group.each do |state|
						- unless state.nil?
							= check_box_tag "q_state_cont_any_#{state.id}", state.name, state.checked, name: 'q[state_cont_any][]'
							= label_tag "q_state_cont_any_#{state.id}", state.name
							br

		= f.submit "Search"
 

	hr

	- if @horses
		- horses_found = @horses.count
	- else 
		- horses_found = 0 
	h4#result= "#{horses_found} Horses Found"



javascript:
	var target = $('#spin');

	var breeds = [];
	$('form :checkbox[id^="q_breed_cont_any_"]').click(function() {
		target.show();
		new Spinner().spin(target[0]);
		$('.advanced-search').css({opacity: '0.3'});
		if (this.checked) {
			breeds.push(this.value);
		} else {
			breeds.splice( $.inArray(this.value,breeds) ,1 );
		}
		
		console.log(breeds);
		
    $.get( '/horses-filter', { "q[breed_cont_any][]": breeds, "q[gender_cont_any][]": genders, "q[state_cont_any][]": states}, function(data) {
    	target.hide();
    	$('.advanced-search').css({opacity: '1'});
    	
    });
    
	});

	var genders = [];
	$('form :checkbox[id^="q_gender_cont_any_"]').click(function() {
		target.show();
		new Spinner().spin(target[0]);
		$('.advanced-search').css({opacity: '0.3'});

		if (this.checked) {
			genders.push(this.value);
		} else {
			genders.splice( $.inArray(this.value,genders) ,1 );
		}
		
		console.log(genders);
		
    $.get( '/horses-filter', { "q[breed_cont_any][]": breeds, "q[gender_cont_any][]": genders, "q[state_cont_any][]": states }, function(data) {
    	target.hide();
    	$('.advanced-search').css({opacity: '1'});
    });
    
	});


	var states = [];
	$('form :checkbox[id^="q_state_cont_any_"]').click(function() {
		target.show();
		new Spinner().spin(target[0]);
		$('.advanced-search').css({opacity: '0.3'});

		if (this.checked) {
			states.push(this.value);
		} else {
			states.splice( $.inArray(this.value, states) ,1 );
		}
		
		console.log(states);
		
    $.get( '/horses-filter', { "q[breed_cont_any][]": breeds, "q[gender_cont_any][]": genders, "q[state_cont_any][]": states }, function(data) {
    	target.hide();
    	$('.advanced-search').css({opacity: '1'});
    });
    
	});



